<!-- Chat Button (Closed State) -->
<div *ngIf="!isOpen" class="fixed bottom-4 right-4 cursor-pointer" (click)="toggleChat()">
    <div class="bg-[#1C2B69] text-white rounded-lg p-4 flex items-center gap-2">
        <i class="fas fa-comment"></i>
        <span>Hi, How can I help?</span>
    </div>
</div>

<!-- Chat Interface (Open State) -->
<div *ngIf="isOpen" class="fixed bottom-4 right-4 w-96 bg-white rounded-lg shadow-xl border border-gray-200">
    <!-- Chat Header -->
    <div class="p-4 border-b flex justify-between items-center bg-[#1C2B69] text-white rounded-t-lg">
        <div>
            <h3 class="font-semibold">Chat Assistant</h3>
            <p class="text-sm text-gray-300">I'm powered by generative AI</p>
        </div>
        <button (click)="toggleChat()" class="text-white hover:text-gray-300">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Chat Messages -->
    <div class="h-96 overflow-y-auto p-4">
        <div *ngFor="let message of messages" 
             [ngClass]="{'flex justify-end': message.sender === 'user', 'flex justify-start': message.sender === 'bot'}">
            <div [ngClass]="{'bg-blue-100': message.sender === 'user', 'bg-gray-100': message.sender === 'bot'}"
                 class="max-w-[80%] rounded-lg p-3 mb-2">
                {{ message.text }}
            </div>
        </div>
    </div>

    <!-- Chat Actions -->
    <div class="p-4 border-t">
        <div class="flex gap-2">
            <button class="w-full px-4 py-2 text-blue-600 border border-blue-600 rounded-md hover:bg-blue-50"
                    (click)="showRecentConversations()">
                <i class="far fa-clock mr-2"></i>
                Show recent conversations
            </button>
            <button class="w-full px-4 py-2 text-blue-600 border border-blue-600 rounded-md hover:bg-blue-50"
                    (click)="endConversation()">
                <i class="fas fa-times mr-2"></i>
                End Conversation
            </button>
        </div>
    </div>

    <!-- Chat Input -->
    <div class="p-4 border-t">
        <div class="flex gap-2">
            <input type="text" 
                   [(ngModel)]="newMessage"
                   (keyup.enter)="sendMessage()"
                   placeholder="Type a Message"
                   class="flex-1 p-2 border rounded-md focus:outline-none focus:border-blue-500">
            <button (click)="sendMessage()"
                    class="p-2 bg-[#1C2B69] text-white rounded-md hover:bg-[#2a3d8f]">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
</div>